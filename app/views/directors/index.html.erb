<h1>Director Management Dashboard</h1>


<label for="nationality-filter">Filter by Nationality:</label>
<select id="nationality-filter">
  <option value="All">All</option>
  <% @directors.map(&:nationality).uniq.each do |nat| %>
    <option value="<%= nat %>"><%= nat %></option>
  <% end %>
</select>

<label for="status-filter">Filter by Status:</label>
<select id="status-filter">
  <option value="All">All</option>
  <option value="First-time">First-time</option>
  <option value="Returning">Returning</option>
</select>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Nationality</th>
      <th>Filmography Count</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    <% @directors.each do |director| %>
      <tr class="director-row">
        <td><%= director.name %></td>
        <td class="director-nationality"><%= director.nationality %></td>
        <td><%= director.filmography_count %></td>
        <td class="director-status"><%= director.status %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<a class="back-link" href="<%= root_path %>">Back to Home</a>

<script>
document.addEventListener("turbo:load", function() {
  console.log("Directors page script loaded");

  const nationalityFilter = document.getElementById("nationality-filter");
  const statusFilter = document.getElementById("status-filter");

  console.log("Nationality filter:", nationalityFilter);
  console.log("Status filter:", statusFilter);

  function filterDirectors() {
    const natValue = nationalityFilter.value;
    const statusValue = statusFilter.value;

    console.log("Filter values - Nationality:", natValue, "Status:", statusValue);

    const rows = document.querySelectorAll(".director-row");
    console.log("Found director rows:", rows.length);

    rows.forEach(function(row) {
      const natCell = row.querySelector(".director-nationality");
      const statusCell = row.querySelector(".director-status");

      console.log("Row - Nationality:", natCell.textContent, "Status:", statusCell.textContent);

      const natMatch = (natValue === "All" || natCell.textContent === natValue);
      const statusMatch = (statusValue === "All" || statusCell.textContent === statusValue);

      if (natMatch && statusMatch) {
        row.style.display = "";
      } else {
        row.style.display = "none";
      }
    });
  }

  if (nationalityFilter) nationalityFilter.addEventListener("change", filterDirectors);
  if (statusFilter) statusFilter.addEventListener("change", filterDirectors);
});
</script>
